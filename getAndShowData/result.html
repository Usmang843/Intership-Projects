<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

</head>

<body>
    <p id="demo"></p>
    <form id="myForm" class="text-center">
        <label for="rollNo">Roll No:</label>
        <input class="input-field" type="number" id="rollNo" name="rollNo" required></input><br><br>
        <button class="btn btn-primary" type="submit">Search</button>
        <br><br><br>
        <div id="result"></div>

    </form>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script>
        document.querySelector("#myForm").addEventListener("submit", function (e) {
            addtable();
            e.preventDefault();    //stop form from submitting

        });

        function addtable() {
            const products = JSON.parse(localStorage.getItem('student') || '{}');
            let rollNo = document.getElementById("rollNo").value;

            if (!products[rollNo]) {
                document.getElementById('result').innerHTML = `<h1 class="text-danger" id="message">Result doesn't exists against this Roll</h1>`;
            }
            else {
                const table = document.createElement('table');
                table.setAttribute('class', 'table table-bordered')
                const headerRow = document.createElement('tr');

                ["Subject", "Marks", "Percentage", "Remarks"].forEach(item => {
                    const th = document.creatElement('th');
                    th.appendChild(document.createTextNode(item));
                    headerRow.appendChild(th);

                });
                const thead = document.createElement('thead');
                thead.appendChild(headerRow);

                table.appendChild(thead);
                const tbody = document.createElement('tbody');

                products[rollNo].subjects.forEach((subject, index) => {
                    const row = document.createElement('tr');
                    const subjecttd = document.createElement('td');
                    const markstd = document.createElement('td');
                    const percenttd = document.createElement('td');
                    const remarks = document.createElement('td');

                    subjecttd.appendChild(document.createTextNode(subject));
                    row.appendChild(subjecttd);

                    markstd.appendChild(document.createTextNode(products[rollNo].marks[index]));
                    row.appendChild(markstd);

                    percentv = Math.floor((products[rollNo].marks[index] / 75) * 100);
                    percent = percentv + "%";
                    percenttd.appendChild(document.createTextNode(percent));
                    row.appendChild(percenttd);
                    grade = ''
                    switch (true) {
                        case percentv >= 80:
                            grade = 'A'
                            break;
                        case percentv >= 50:
                            grade = 'B'
                            break;
                        case percentv >= 33:
                            grade = 'C'
                            break;
                        default:
                            grade = 'Fail'
                    }
                    remarks.appendChild(document.createTextNode(grade));

                    row.appendChild(remarks);

                    tbody.appendChild(row)

                });
                table.appendChild(tbody);

                products[rollNo].marks.forEach((marks, index) => {
                    const row = document.createElement('tr');
                    const percenttd = document.createElement('td');

                    table.appendChild(row);
                });


                document.getElementById("result").innerHTML = '';
                document.getElementById("result").appendChild(table);
            }
        }

    </script>
</body>

</html>